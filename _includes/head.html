<!-- Google tag (gtag.js) -->
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

{% assign base_desc = page.description | default: page.subtitle | default: site.description %}
{% assign base_desc = base_desc | strip_html | strip_newlines | strip %}
{% capture desc %}{{ base_desc }} Thoughts by {{ site.author }} at {{ site.affiliation }}.{% endcapture %}
{% assign desc = desc | strip %}
{% assign favicon_location = site.favicon_location | prepend: "/" | relative_url %}
{% assign favicon_location_absolute = site.favicon_location | prepend: "/" | absolute_url %}
{% assign canonical_url = page.url | replace:'index.html','' | absolute_url %}
{% assign tag_keywords = page.tags | join: ", " %}
{% assign robots_directive = "index,follow,max-image-preview:large" %}
{% if page.url == "/404.html" %}
  {% assign robots_directive = "noindex,follow" %}
{% endif %}

{% if page.layout == "post" %}
  {% assign title = page.title | append: " | Chris Su CMU | " | append: site.title %}
  {% assign og_type = "article" %}
{% elsif page.title %}
  {% assign title = page.title | append: " | Chris Su CMU" %}
  {% assign og_type = "website" %}
{% else %}
  {% assign title = site.title | append: " | Chris Su CMU Blog" %}
  {% assign og_type = "website" %}
{% endif %}

<title>{{ title }}</title>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="author" content="{{ site.author }}">
<meta name="description" content="{{ desc }}">
<meta name="robots" content="{{ robots_directive }}">
<meta name="keywords" content="{{ site.keywords | join: ', ' }}{% if page.tags and page.tags.size > 0 %}, {{ tag_keywords }}{% endif %}">
<link rel="canonical" href="{{ canonical_url }}">

<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="{{ '/css/main.css' | relative_url }}">
<link rel="icon" type="image/ico" href="{{ favicon_location }}">
<link rel="shortcut-icon" type="image/ico" href="{{ favicon_location }}">

<meta property="og:type" content="{{ og_type }}">
<meta property="og:site_name" content="{{ site.title }}">
<meta property="og:title" content="{{ title }}">
<meta property="og:description" content="{{ desc }}">
<meta property="og:url" content="{{ canonical_url }}">
<meta property="og:image" itemprop="image" content="{{ favicon_location_absolute }}">

<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="{{ title }}">
<meta name="twitter:description" content="{{ desc }}">
<meta name="twitter:image" content="{{ favicon_location_absolute }}">

{% if page.layout == "post" %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": {{ page.title | jsonify }},
  "description": {{ desc | jsonify }},
  "datePublished": {{ page.date | date_to_xmlschema | jsonify }},
  "dateModified": {{ page.last_modified_at | default: page.date | date_to_xmlschema | jsonify }},
  "author": {
    "@type": "Person",
    "name": {{ site.author | jsonify }},
    "affiliation": {
      "@type": "CollegeOrUniversity",
      "name": {{ site.affiliation | jsonify }}
    }
  },
  "publisher": {
    "@type": "Person",
    "name": {{ site.author | jsonify }}
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": {{ canonical_url | jsonify }}
  },
  "url": {{ canonical_url | jsonify }}
}
</script>
{% else %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": {{ site.title | jsonify }},
  "description": {{ site.description | jsonify }},
  "url": {{ '/' | absolute_url | jsonify }},
  "author": {
    "@type": "Person",
    "name": {{ site.author | jsonify }},
    "affiliation": {
      "@type": "CollegeOrUniversity",
      "name": {{ site.affiliation | jsonify }}
    }
  }
}
</script>
{% endif %}
